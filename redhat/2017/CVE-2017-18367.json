{
  "bugzilla": {
    "description": "\nCVE-2017-18367 libseccomp-golang: mishandling of multiple argument rules leading to a bypass of intended access restrictions\n    ",
    "id": "1706826",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1706826"
  },
  "cvss3": {
    "cvss3_base_score": "6.5",
    "cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N",
    "status": "draft"
  },
  "cwe": "CWE-305",
  "details": [
    "\nlibseccomp-golang 0.9.0 and earlier incorrectly generates BPFs that OR multiple arguments rather than ANDing them. A process running under a restrictive seccomp filter that specified multiple syscall arguments could bypass intended access restrictions by specifying a single matching argument.\n    "
  ],
  "name": "CVE-2017-18367",
  "package_state": [
    {
      "cpe": "cpe:/a:redhat:openshift:3.10",
      "fix_state": "Will not fix",
      "package_name": "atomic-openshift",
      "product_name": "Red Hat OpenShift Container Platform 3.10"
    },
    {
      "cpe": "cpe:/a:redhat:openshift:3.11",
      "fix_state": "Affected",
      "package_name": "atomic-openshift",
      "product_name": "Red Hat OpenShift Container Platform 3.11"
    },
    {
      "cpe": "cpe:/a:redhat:openshift:4.1",
      "fix_state": "Affected",
      "package_name": "atomic-openshift",
      "product_name": "Red Hat OpenShift Container Platform 4.1"
    }
  ],
  "public_date": "2019-04-24T00:00:00",
  "statement": "\nThis issue may affect OpenShift Container Platform 3.x and 4.x if you are providing a custom Seccomp profile using Security Context Constraints [1]. The custom Seccomp profile would need to specify multiple arguments, such as below, from [2].\n\n{\n  \"names\": [\n    \"socketcall\"\n  ],\n  \"action\": \"SCMP_ACT_ALLOW\",\n  \"args\": [\n    {\n      \"index\": 0,\n      \"value\": 1,\n      \"valueTwo\": 0,\n      \"op\": \"SCMP_CMP_EQ\"\n    },\n    {\n      \"index\": 1,\n      \"value\": 1,\n      \"valueTwo\": 0,\n      \"op\": \"SCMP_CMP_EQ\"\n    }\n  ],\n  \"comment\": \"\",\n  \"includes\": {},\n  \"excludes\": {}\n},\n\nIf such a profile was used the arguments could be combined as an OR rule, not AND, as the user might expect from Seccomp.\n\n[1] https://docs.openshift.com/container-platform/4.1/authentication/managing-security-context-constraints.html\n[2] https://github.com/moby/moby/issues/32714#issuecomment-295532163\n\nRed Hat OpenShift Container Platform 3.10: \nThis vulnerability has been rated as having a security impact of Moderate. After evaluation and in accordance with the criteria noted in the product support life cycle, there are no plans to address this issue in an upcoming release. Please contact Red Hat Support for further information.\n\nRed Hat OpenShift Container Platform 3.11: \nThis vulnerability is currently targeted to be addressed in an upcoming release.\n\nRed Hat OpenShift Container Platform 4.1: \nThis vulnerability is currently targeted to be addressed in an upcoming release.\n    ",
  "threat_severity": "Moderate"
}