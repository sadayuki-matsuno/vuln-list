{
  "affected_release": [
    {
      "advisory": "RHSA-2019:1024",
      "cpe": "cpe:/o:redhat:enterprise_linux:7",
      "package": "flatpak-1.0.2-5.el7_6",
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2019-05-07T00:00:00"
    },
    {
      "advisory": "RHSA-2019:1143",
      "cpe": "cpe:/a:redhat:enterprise_linux:8",
      "package": "flatpak-1.0.6-3.el8_0",
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2019-05-13T00:00:00"
    }
  ],
  "bugzilla": {
    "description": "\nCVE-2019-10063 flatpak: Sandbox bypass via IOCSTI (incomplete fix for CVE-2017-5226)\n    ",
    "id": "1695973",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1695973"
  },
  "cvss3": {
    "cvss3_base_score": "8.8",
    "cvss3_scoring_vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H",
    "status": "verified"
  },
  "cwe": "CWE-266",
  "details": [
    "\nFlatpak before 1.0.8, 1.1.x and 1.2.x before 1.2.4, and 1.3.x before 1.3.1 allows a sandbox bypass. Flatpak versions since 0.8.1 address CVE-2017-5226 by using a seccomp filter to prevent sandboxed apps from using the TIOCSTI ioctl, which could otherwise be used to inject commands into the controlling terminal so that they would be executed outside the sandbox after the sandboxed app exits. This fix was incomplete: on 64-bit platforms, the seccomp filter could be bypassed by an ioctl request number that has TIOCSTI in its 32 least significant bits and an arbitrary nonzero value in its 32 most significant bits, which the Linux kernel would treat as equivalent to TIOCSTI.\n    "
  ],
  "name": "CVE-2019-10063",
  "public_date": "2019-03-22T00:00:00",
  "statement": "\nA sandbox bypass flaw was found in the way bubblewrap which is used for sandboxing flatpak applications handled the TIOCSTI ioctl. A malicious flatpak application could use this flaw to inject commands into the controlled terminal of the host after the flatpak applications exits. (This flaw is caused due to incomplete fix for CVE-2017-5226).\n\nThis flaw can be exploited by malicious flatpak applications which include the code to exploit the wrong handling of the TIOCSTI ioctl (AV:L). No special action is needed to be performed by the attacker just having the exploit code should be enough for bypassing the sandbox restrictions (AC:L), Also the applications needs to be downloaded and run by the victim (PR:L). The flaw results in code being executed on the host system which is running the sandboxed application therefore this affects the host beyond the sandboxed application (S:C). Lastly considering the worst scenario in which the flatpak is run as root on the host system, this flaw can result in the malicious application running code as root on the host system (CIA:H).\n    ",
  "threat_severity": "Important",
  "upstream_fix": "flatpak 1.3.2"
}