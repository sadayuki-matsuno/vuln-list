{
  "acknowledgement": "\nRed Hat would like to thank Bj√∂rn Baumbach (SerNet) for reporting this issue.\n    ",
  "bugzilla": {
    "description": "\nCVE-2019-3870 samba: World writable files in Samba AD DC private/ dir\n    ",
    "id": "1689010",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1689010"
  },
  "cvss3": {
    "cvss3_base_score": "6.1",
    "cvss3_scoring_vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:H",
    "status": "draft"
  },
  "cwe": "CWE-125",
  "details": [
    "\nA vulnerability was found in Samba from version (including) 4.9 to versions before 4.9.6 and 4.10.2. During the creation of a new Samba AD DC, files are created in a private subdirectory of the install location. This directory is typically mode 0700, that is owner (root) only access. However in some upgraded installations it will have other permissions, such as 0755, because this was the default before Samba 4.8. Within this directory, files are created with mode 0666, which is world-writable, including a sample krb5.conf, and the list of DNS names and servicePrincipalName values to update.\n    ",
    "\nA vulnerability was found in Samba versions 4.9 and later. During the creation of a new Samba AD DC, files are created in a private subdirectory of the install location. This directory is typically mode 0700, that is owner (root) only access.  However in some upgraded installations it will have other permissions, such as 0755, because this was the default before Samba 4.8. Within this directory, files are created with mode 0666, which is world-writable, including a sample krb5.conf, and the list of DNS names and servicePrincipalName values to update.\n    "
  ],
  "name": "CVE-2019-3870",
  "package_state": [
    {
      "cpe": "cpe:/a:redhat:rhev_manager:4",
      "fix_state": "Not affected",
      "package_name": "redhat-virtualization-host",
      "product_name": "Red Hat Virtualization 4"
    },
    {
      "cpe": "cpe:/a:redhat:storage:3",
      "fix_state": "Not affected",
      "package_name": "samba",
      "product_name": "Red Hat Gluster Storage 3"
    },
    {
      "cpe": "cpe:/o:redhat:enterprise_linux:5",
      "fix_state": "Not affected",
      "package_name": "samba",
      "product_name": "Red Hat Enterprise Linux 5"
    },
    {
      "cpe": "cpe:/o:redhat:enterprise_linux:6",
      "fix_state": "Not affected",
      "package_name": "samba",
      "product_name": "Red Hat Enterprise Linux 6"
    },
    {
      "cpe": "cpe:/o:redhat:enterprise_linux:7",
      "fix_state": "Not affected",
      "package_name": "samba",
      "product_name": "Red Hat Enterprise Linux 7"
    },
    {
      "cpe": "cpe:/o:redhat:enterprise_linux:8",
      "fix_state": "Not affected",
      "package_name": "samba",
      "product_name": "Red Hat Enterprise Linux 8"
    }
  ],
  "public_date": "2019-04-09T00:00:00",
  "references": [
    "\nhttps://bugzilla.samba.org/show_bug.cgi?id=13834\nhttps://www.samba.org/samba/security/CVE-2019-3870.html\n    "
  ],
  "statement": "\nThis issue did not affect the versions of samba as shipped with Red Hat Enterprise Linux or Red Hat Gluster Storage 3 as they did not include support for Active Directory Domain Controller.\n    ",
  "threat_severity": "Moderate",
  "upstream_fix": "samba 4.9.6, samba 4.10.2"
}