{
  "acknowledgement": "\nThis issue was discovered by Pavel Moravec (Red Hat).\n    ",
  "affected_release": [
    {
      "advisory": "RHSA-2019:1223",
      "cpe": "cpe:/a:redhat:rhel_satellite_tools:5",
      "product_name": "Satellite Tools 6.2 for RHEL 5",
      "release_date": "2019-05-14T00:00:00"
    },
    {
      "advisory": "RHSA-2019:1223",
      "cpe": "cpe:/a:redhat:rhel_satellite_tools:6",
      "product_name": "Satellite Tools 6.2 for RHEL 6",
      "release_date": "2019-05-14T00:00:00"
    },
    {
      "advisory": "RHSA-2019:1223",
      "cpe": "cpe:/a:redhat:rhel_satellite_tools:7",
      "product_name": "Satellite Tools 6.2 for RHEL 7",
      "release_date": "2019-05-14T00:00:00"
    },
    {
      "advisory": "RHSA-2019:1223",
      "cpe": "cpe:/a:redhat:rhel_satellite_tools:8",
      "product_name": "Satellite Tools 6.5 for RHEL 8",
      "release_date": "2019-05-14T00:00:00"
    },
    {
      "advisory": "RHSA-2019:0734",
      "cpe": "cpe:/a:redhat:satellite:6.1::el6",
      "product_name": "Red Hat Satellite 6.1 - Optional",
      "release_date": "2019-04-09T00:00:00"
    },
    {
      "advisory": "RHSA-2019:0734",
      "cpe": "cpe:/a:redhat:satellite:6.2::el7",
      "product_name": "Red Hat Satellite 6.2",
      "release_date": "2019-04-09T00:00:00"
    },
    {
      "advisory": "RHSA-2019:0733",
      "cpe": "cpe:/a:redhat:satellite:6.3::el7",
      "product_name": "Red Hat Satellite 6.3",
      "release_date": "2019-04-09T00:00:00"
    },
    {
      "advisory": "RHSA-2019:0735",
      "cpe": "cpe:/a:redhat:satellite:6.4::el7",
      "product_name": "Red Hat Satellite 6.4 for RHEL 7",
      "release_date": "2019-04-09T00:00:00"
    },
    {
      "advisory": "RHSA-2019:0734",
      "cpe": "cpe:/a:redhat:satellite_capsule:6.1::el6",
      "product_name": "Red Hat Satellite Capsule 6.1",
      "release_date": "2019-04-09T00:00:00"
    },
    {
      "advisory": "RHSA-2019:0734",
      "cpe": "cpe:/a:redhat:satellite_capsule:6.2::el7",
      "product_name": "Red Hat Satellite Capsule 6.2",
      "release_date": "2019-04-09T00:00:00"
    },
    {
      "advisory": "RHSA-2019:0733",
      "cpe": "cpe:/a:redhat:satellite_capsule:6.3::el7",
      "product_name": "Red Hat Satellite Capsule 6.3",
      "release_date": "2019-04-09T00:00:00"
    },
    {
      "advisory": "RHSA-2019:0735",
      "cpe": "cpe:/a:redhat:satellite_capsule:6.4::el7",
      "product_name": "Red Hat Satellite 6.4 for RHEL 7",
      "release_date": "2019-04-09T00:00:00"
    }
  ],
  "bugzilla": {
    "description": "\nCVE-2019-3845 qpid-dispatch-router: QMF methods exposed to goferd via qdrouterd\n    ",
    "id": "1684275",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1684275"
  },
  "cvss3": {
    "cvss3_base_score": "8.0",
    "cvss3_scoring_vector": "CVSS:3.0/AV:A/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "cwe": "CWE-284",
  "details": [
    "\nA lack of access control was found in the message queues maintained by Satellite's QPID broker and used by katello-agent in versions before Satellite 6.2, Satellite 6.1 optional and Satellite Capsule 6.1. A malicious user authenticated to a host registered to Satellite (or Capsule) can use this flaw to access QMF methods to any host also registered to Satellite (or Capsule) and execute privileged commands.\n    ",
    "\nA lack of access control was found in the message queues maintained by Satellite's QPID broker and used by katello-agent. A malicious user authenticated to a host registered to Satellite (or Capsule) can use this flaw to access QMF methods to any host also registered to Satellite (or Capsule) and execute privileged commands.\n    "
  ],
  "mitigation": "\nOn Satellite Server follow the instructions below:\n\n* Modify /etc/qpid/qpidd.conf to add this line:\n\nacl-file=qpid_acls.acl\n\n\n* Create a new file: /var/lib/qpidd/.qpidd/qpid_acls.acl with content:\n\nacl allow katello_agent@QPID create queue\nacl allow katello_agent@QPID consume queue\nacl allow katello_agent@QPID access exchange\nacl allow katello_agent@QPID access queue\nacl allow katello_agent@QPID publish exchange routingkey=pulp.task\nacl allow katello_agent@QPID publish exchange name=qmf.default.direct\nacl allow katello_agent@QPID access method name=create\n\nacl deny-log katello_agent@QPID access method name=*\nacl deny-log katello_agent@QPID all all\n\n# allow anything else\nacl allow all all\n\n\n* As root, execute the command:\n# systemctl restart qpidd\n\n\n* In /etc/qpid-dispatch/qdrouterd.conf modify the connector:\n\nconnector {\n\tname: broker\n\thost: localhost\n\tport: 5671\n\tsasl-mechanisms: PLAIN\n\tsasl-username: katello_agent\n\tsasl-password: katello_agent\n\trole: route-container\n\tssl-profile: client\n\tidle-timeout-seconds: 0\n}\n\n\n* As root, execute the command:\n# systemctl restart qdrouterd\n\n\nThese ACLs will prevent clients to redirect or move messages to various queues which is the nature of the CVE.\nAll other behavior will be unchanged (acl allow all all) which is the current baseline.\n    ",
  "name": "CVE-2019-3845",
  "package_state": {
    "cpe": "cpe:/a:redhat:network_satellite:6",
    "fix_state": "Affected",
    "package_name": "qpid-dispatch-router",
    "product_name": "Red Hat Satellite 6"
  },
  "public_date": "2019-04-09T13:27:00",
  "statement": "\nOn Red Hat Satellite 6.5, the Satellite 6.5 GA release includes a version of katello-installer-base that provides the fixes for this issue.\n    ",
  "threat_severity": "Important"
}