{
  "bugzilla": {
    "description": "\nCVE-2019-13139 docker: command injection due to a missing validation of the git ref command\n    ",
    "id": "1732627",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1732627"
  },
  "cvss3": {
    "cvss3_base_score": "6.7",
    "cvss3_scoring_vector": "CVSS:3.0/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H",
    "status": "draft"
  },
  "cwe": "CWE-77",
  "details": [
    "\nIn Docker before 18.09.4, an attacker who is capable of supplying or manipulating the build path for the \"docker build\" command would be able to gain command execution. An issue exists in the way \"docker build\" processes remote git URLs, and results in command injection into the underlying \"git clone\" command, leading to code execution in the context of the user executing the \"docker build\" command. This occurs because git ref can be misinterpreted as a flag.\n    ",
    "\nA command injection flaw was discovered in Docker during the `docker build` command. By providing a specially crafted path argument for the container to build, it is possible to inject command options to the `git fetch`/`git checkout` commands that are executed by Docker and to execute code with the privileges of the user running Docker. A local attacker who can run `docker build` with a controlled build path, or a remote attacker who has control over the docker build path, could elevate their privileges or execute code.\n    "
  ],
  "name": "CVE-2019-13139",
  "package_state": [
    {
      "cpe": "cpe:/a:redhat:openshift:3.6",
      "fix_state": "Out of support scope",
      "package_name": "docker",
      "product_name": "Red Hat OpenShift Container Platform 3.6"
    },
    {
      "cpe": "cpe:/a:redhat:openshift:3.7",
      "fix_state": "Out of support scope",
      "package_name": "docker",
      "product_name": "Red Hat OpenShift Container Platform 3.7"
    },
    {
      "cpe": "cpe:/o:redhat:enterprise_linux:7",
      "fix_state": "Affected",
      "package_name": "docker",
      "product_name": "Red Hat Enterprise Linux 7"
    }
  ],
  "public_date": "2019-03-26T00:00:00",
  "statement": "\nBoth 1.12 and 1.13 versions of docker shipped with Red Hat Enterprise Linux Extras and OpenShift Container Platform 3 are vulnerable to this flaw, though they are less impacted than upstream. The injected command options passed to `docker build` through the docker build path are handled by `git checkout` rather than `git fetch`, which provides limited options for an attacker to exploit. It is unlikely that code execution is possible, though it cannot be ruled out entirely.\n\nRed Hat Enterprise Linux 7: \nThis vulnerability is currently targeted to be addressed in an upcoming release.\n\nRed Hat OpenShift Container Platform 3.6: \nThis vulnerability has been rated as having a security impact of Moderate. After evaluation and in accordance with the criteria noted in the product support life cycle, there are no plans to address this issue in an upcoming release. Please contact Red Hat Support for further information.\n\nRed Hat OpenShift Container Platform 3.7: \nThis vulnerability has been rated as having a security impact of Moderate. After evaluation and in accordance with the criteria noted in the product support life cycle, there are no plans to address this issue in an upcoming release. Please contact Red Hat Support for further information.\n    ",
  "threat_severity": "Moderate",
  "upstream_fix": "docker engine 18.09.4"
}