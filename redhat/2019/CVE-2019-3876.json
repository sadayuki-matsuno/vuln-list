{
  "acknowledgement": "\nThis issue was discovered by Mo Khan (Red Hat).\n    ",
  "affected_release": {
    "advisory": "RHSA-2019:1851",
    "cpe": "cpe:/a:redhat:openshift:3.11::el7",
    "package": "atomic-openshift-3.11.129-1.git.0.bd4f2d5.el7",
    "product_name": "Red Hat OpenShift Container Platform 3.11",
    "release_date": "2019-07-24T00:00:00"
  },
  "bugzilla": {
    "description": "\nCVE-2019-3876 web-console: XSS in OAuth server /oauth/token/request endpoint\n    ",
    "id": "1691107",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1691107"
  },
  "cvss3": {
    "cvss3_base_score": "5.0",
    "cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L",
    "status": "verified"
  },
  "cwe": "CWE-79",
  "details": [
    "\nA flaw was found in the /oauth/token/request custom endpoint of the OpenShift OAuth server allowing for XSS generation of CLI tokens due to missing X-Frame-Options and CSRF protections. If not otherwise prevented, a separate XSS vulnerability via JavaScript could further allow for the extraction of these tokens.\n    ",
    "\nA flaw was found in the /oauth/token/request custom endpoint of the OpenShift OAuth server allowing for XSS generation of CLI tokens due to missing X-Frame-Options and CSRF protections. If not otherwise prevented, a separate XSS vulnerability via JavaScript could further allow for the extraction of these tokens.\n    "
  ],
  "mitigation": "\nSince at least v3.4, the OpenShift documentation [1] has specified the format for  corsAllowedOrigins to accurately match intended hostnames.  Since at least v3.7, installs will default to use the correct regular expression formatted variables.  Earlier versions may be configured with plain strings, a configuration which will persist across cluster upgrades, opening them to cross origin vulnerabilities such as this.\n\n\nAt a minimum, you should ensure that the corsAllowedOrigin definition within master-config.yaml contains elements in the form \n\n~~~\ncorsAllowedOrigins:\n- (?i)//my\\.subdomain\\.domain\\.com(:|\\z)\n~~~\n\nand not the form\n\n~~~\ncorsAllowedOrigins:\n- domain.com\n~~~\n\nas the first will permit cross origin requests only if the host matches exactly, whereas the second will permit from any host that merely contains the string (such as ABCDdomain.com or even domain.comABCD.com).\n\n\n\nFootnotes:\n\n[1] https://docs.openshift.com/container-platform/3.4/architecture/infrastructure_components/web_console.html#corsAllowedOrigins\n    ",
  "name": "CVE-2019-3876",
  "package_state": [
    {
      "cpe": "cpe:/a:redhat:openshift:3.10",
      "fix_state": "Affected",
      "package_name": "atomic-openshift",
      "product_name": "Red Hat OpenShift Container Platform 3.10"
    },
    {
      "cpe": "cpe:/a:redhat:openshift:3.4",
      "fix_state": "Out of support scope",
      "package_name": "atomic-openshift",
      "product_name": "Red Hat OpenShift Container Platform 3.4"
    },
    {
      "cpe": "cpe:/a:redhat:openshift:3.5",
      "fix_state": "Out of support scope",
      "package_name": "atomic-openshift",
      "product_name": "Red Hat OpenShift Container Platform 3.5"
    },
    {
      "cpe": "cpe:/a:redhat:openshift:3.6",
      "fix_state": "Out of support scope",
      "package_name": "atomic-openshift",
      "product_name": "Red Hat OpenShift Container Platform 3.6"
    },
    {
      "cpe": "cpe:/a:redhat:openshift:3.7",
      "fix_state": "Out of support scope",
      "package_name": "atomic-openshift",
      "product_name": "Red Hat OpenShift Container Platform 3.7"
    },
    {
      "cpe": "cpe:/a:redhat:openshift:3.9",
      "fix_state": "Affected",
      "package_name": "atomic-openshift",
      "product_name": "Red Hat OpenShift Container Platform 3.9"
    },
    {
      "cpe": "cpe:/a:redhat:openshift:4.1",
      "fix_state": "Not affected",
      "package_name": "openshift",
      "product_name": "Red Hat OpenShift Container Platform 4.1"
    }
  ],
  "public_date": "2019-03-27T00:24:00",
  "statement": "\nThis issue affects the OAuth server shipped in OpenShift Container Platform version v3.0 through v3.11.  Red Hat Product Security has rated this issue as having a security impact of Moderate.\n\nFor additional information, refer to the Issue Severity Classification: https://access.redhat.com/security/updates/classification/.\n\nRed Hat OpenShift Container Platform 3.10: \nThis vulnerability is currently targeted to be addressed in an upcoming release.\n\nRed Hat OpenShift Container Platform 3.4: \nThis vulnerability has been rated as having a security impact of Moderate. After evaluation and in accordance with the criteria noted in the product support life cycle, there are no plans to address this issue in an upcoming release. Please contact Red Hat Support for further information.\n\nRed Hat OpenShift Container Platform 3.5: \nThis vulnerability has been rated as having a security impact of Moderate. After evaluation and in accordance with the criteria noted in the product support life cycle, there are no plans to address this issue in an upcoming release. Please contact Red Hat Support for further information.\n\nRed Hat OpenShift Container Platform 3.6: \nThis vulnerability has been rated as having a security impact of Moderate. After evaluation and in accordance with the criteria noted in the product support life cycle, there are no plans to address this issue in an upcoming release. Please contact Red Hat Support for further information.\n\nRed Hat OpenShift Container Platform 3.7: \nThis vulnerability has been rated as having a security impact of Moderate. After evaluation and in accordance with the criteria noted in the product support life cycle, there are no plans to address this issue in an upcoming release. Please contact Red Hat Support for further information.\n\nRed Hat OpenShift Container Platform 3.9: \nThis vulnerability is currently targeted to be addressed in an upcoming release.\n    ",
  "threat_severity": "Moderate"
}